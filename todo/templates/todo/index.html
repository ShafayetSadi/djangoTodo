{% extends 'todo/base.html' %}
{% block content %}

{% load partials %}

<div
    class="box-border h-screen">
    <div
        class="flex p-10 h-full gap-10 text-[#C8C8C8]">
        <nav
            class="bg-[#212121] rounded-xl border-2 border-[#333333] flex flex-col justify-between">
            <a href="{% url 'profile' %}">
            <div
                class="bg-[#1F1F1F] m-2 p-2 w-52 flex justify-between hover:bg-black rounded-xl">
                <img class="rounded-2xl w-12" src="{{ user.profile.profile_pic.url  }}"
                    alt="Profile" />
                <div class="p-2">{{ user.username }}</div>
                
            </div>
            </a>
            <div class="flex justify-center">
                <ul>
                    <li class="p-2">All Tasks</li>
                    <li>Important</li>
                    <li>Completed!</li>
                    <li>Do It Now</li>
                </ul>
            </div>
            <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <div class="p-4 flex justify-center hover:bg-black mx-12 my-2 rounded-xl">
                    {% if user.is_authenticated %}
                    <a href="{% url 'logout' %}"><button>Sign Out</button></a>
                    {% else %}
                        <a href="{% url 'login' %}"><button>Sign In</button></a>
                    {% endif %}
                </div>
            </form>
        </nav>
        <div
            class="bg-[#212121] rounded-xl border-2 border-[#333333] overflow-scroll">
            <div class="flex justify-between px-4 py-2">
                <h1 class="text-2xl font-bold">All Task</h1>
                <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-2 rounded"
                    hx-post="{% url 'add' %}"
                    hx-target="#add-task-form"
                    hx-swap="innerHTML"
                    hx-trigger="click"
                >
                    Add Task
                  </button>
            </div>
            <main
                class="">
                <div id="task-body" class="m-4 flex flex-wrap gap-6 justify-center">
                
                {% for task in tasks %}
                    {% partialdef task-partial inline=True %}
                    
                        <div
                            class="bg-[#313131] h-56 w-full max-w-[270px] rounded-xl border-[#9a7f7f]">
                            <div
                                class="p-2 flex flex-col">
                                <div
                                    class="text-xl text-blue-700 font-semibold">
                                    {{ task.title }}
                                </div>
                                <div
                                    class="p-1 w-full h-[100px] overflow-scroll text-base">
                                    {{ task.description }}
                                </div>
                                {% if task.due_date %}
                                    <div class="px-1 py-1 font-semibold text-emerald-500">{{ task.due_date }}</div>
                                {% else %}
                                <div class="px-1 py-1 font-semibold text-emerald-500">{{ task.created_at|date:'F j, Y' }}</div>
                                {% endif %}
                                <div
                                    class="flex gap-2 my-2">
                                    {% if task.important %}
                                    <button
                                        class="bg-blue-600 rounded-2xl text-sm font-bold h-8 px-2">Important</button>
                                    {% endif %}
                                    {% if task.completed %}
                                    <button
                                        class="bg-green-600 rounded-2xl text-sm font-bold h-8 px-2">Completed</button>
                                    {% else %}
                                    <button
                                        class="bg-red-600 rounded-2xl text-sm font-bold h-8 px-2">Incomplete</button>
                                    {% endif %}
                                    <button
                                        class="bg-pink-600 rounded-2xl text-sm font-bold h-8 px-2">Edit</button>
                                    <button
                                        class="bg-red-900 rounded-2xl text-sm font-bold h-8 px-2">Delete</button>
                                </div>
                            </div>
                        </div>
                    {% endpartialdef %}
                {% endfor %}
                

                <div
                    class="h-56 w-full max-w-[270px] rounded-xl border-4 border-dashed border-[#313131] flex justify-center items-center
                    hover:bg-gray-700 cursor-pointer"
                    hx-post="{% url 'add' %}"
                    hx-target="#add-task-form"
                    hx-swap="innerHTML"
                    hx-trigger="click"
                    >
                        <button
                            class="w-full h-full flex justify-center items-center"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-20 w-20 text-gray-500" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 3a1 1 0 00-1 1v5H4a1 1 0 100 2h5v5a1 1 0 102 0v-5h5a1 1 0 100-2h-5V4a1 1 0 00-1-1z" clip-rule="evenodd" />
                              </svg>
                        </button>
                </div>
            </div>
        </div>
        </main>
    </div>
</div>
    <div id="add-task-form" class="h-screen w-screen">
        <div>

        </div>
    </div>
</div>
{% endblock %}
